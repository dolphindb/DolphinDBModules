#include "setup/settings.txt"
use ta

@testing:case="test_ta_function_trix_period=14"
real = [10.342592,9.095076,10.9061,10.22057,10.485838,8.517628,8.906269,10.097941,10.513,11.910554,9.209217,9.082069,9.414413,9.556552,8.972413,8.976626,10.671621,9.730138,11.372122,9.774195,11.048798,10.461265,9.925939,10.473274,10.55412,8.327869,10.591783,9.052043,8.824634,9.177284,10.336412,11.840595,10.864173,9.148324,9.427643,10.487955,10.088826,11.573955,10.417412,11.547382,8.997351,10.048614,12.241551,10.868677,9.391717,10.128997,11.398558,10.290269,10.598877,10.455757,9.933287,8.376568,10.107144,9.285592,9.106795,9.171969,9.185604,11.212213,9.640378,10.298902]
out = [0.1965312, 0.18814103, 0.22648739, 0.26004356, 0.25330547, 0.23765253, 0.24624566, 0.24347862, 0.24012991, 0.23264597, 0.21015535, 0.14249306, 0.08870878, 0.02728742, -0.04034835, -0.10723307, -0.16995229, -0.17964603, -0.19028392, -0.18527152]
assert 1, eqObj(trix(real, 14)[40:], out, 6)

@testing:case="test_ta_function_trix_period=14_starting_NULL"
real = [NULL,NULL,NULL,10.342592,9.095076,10.9061,10.22057,10.485838,8.517628,8.906269,10.097941,10.513,11.910554,9.209217,9.082069,9.414413,9.556552,8.972413,8.976626,10.671621,9.730138,11.372122,9.774195,11.048798,10.461265,9.925939,10.473274,10.55412,8.327869,10.591783,9.052043,8.824634,9.177284,10.336412,11.840595,10.864173,9.148324,9.427643,10.487955,10.088826,11.573955,10.417412,11.547382,8.997351,10.048614,12.241551,10.868677,9.391717,10.128997,11.398558,10.290269,10.598877,10.455757,9.933287,8.376568,10.107144,9.285592,9.106795,9.171969,9.185604,11.212213,9.640378,10.298902]
out = [0.1965312, 0.18814103, 0.22648739, 0.26004356, 0.25330547, 0.23765253, 0.24624566, 0.24347862, 0.24012991, 0.23264597, 0.21015535, 0.14249306, 0.08870878, 0.02728742, -0.04034835, -0.10723307, -0.16995229, -0.17964603, -0.19028392, -0.18527152]
assert 1, eqObj(trix(real, 14)[43:], out, 6)

@testing:case="test_ta_function_trix_period=2"
real = [10.342592,9.095076,10.9061,10.22057,10.485838,8.517628,8.906269,10.097941,10.513,11.910554,9.209217,9.082069,9.414413,9.556552,8.972413,8.976626,10.671621,9.730138,11.372122,9.774195,11.048798,10.461265,9.925939,10.473274,10.55412,8.327869,10.591783,9.052043,8.824634,9.177284,10.336412,11.840595,10.864173,9.148324,9.427643,10.487955,10.088826,11.573955,10.417412,11.547382,8.997351,10.048614,12.241551,10.868677,9.391717,10.128997,11.398558,10.290269,10.598877,10.455757,9.933287,8.376568,10.107144,9.285592,9.106795,9.171969,9.185604,11.212213,9.640378,10.298902]
out = [-1.39762422, 0.61203779, 3.3160077, 0.85247389, -1.20229709, -1.65079148, -1.30112618, -1.6075947, -1.65648953, 0.79505564, 0.99282553, 2.81927425, 1.46791971, 1.85133079, 1.2731701, 0.06743058, 0.04463271, 0.27105137, -2.3020011 , -0.94402216, -1.52770272, -2.19073945, -1.83790323, 0.22734453, 3.43313223, 3.34815958, 0.36824285, -1.12845931, -0.2688892, 0.00468949, 1.91060764, 1.36625168, 1.99365121, -0.83818753, -1.33011439, 1.5119938, 1.49542426, -0.78108031, -1.24083216, 0.41611155, 0.14374054,  0.11498461, -0.05321972, -0.7677256, -2.96617858, -1.86280679, -1.64368733, -1.68332248, -1.45417162, -1.10803813, 1.91769682, 1.41008897, 1.40712497]
assert 1, eqObj(trix(real, 3)[7:], out, 6)


@testing:case="test_ta_function_stochf_context_by"
precision = 6
tickTB = loadText(DATA_DIR+"/ticks1.csv")

res = (exec trix(close, 14) as trix from tickTB context by sym).trix
out = [00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,-0.803048,-0.859778,-0.909195,-0.941833,-0.969205,-0.97887,-0.975309,-0.960866,-0.928201,-0.87593,-0.81031,-0.737394,-0.655726,-0.571722,-0.464987,-0.342376,-0.221221,-0.104359,0.01369,0.129877,0.232724,0.32152,0.3948,0.458374,0.505024,0.534076,0.558248,0.580529,0.593801,0.602818,0.612931,0.620493,0.622605,0.593187,0.529631,0.453776,0.372994,0.282925,0.194274,0.107313,0.025711,-0.056809,-0.137476,-0.224033,-0.310372,-0.396864,-0.469658,-0.521779,-0.56347,-0.590688,-0.609392,-0.61679,-0.613964,-0.60621,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,0.024628,0.058992,0.075926,0.085255,0.086047,0.066406,0.034535,-0.02588,-0.119937,-0.218,-0.297957,-0.362938,-0.41757,-0.464571,-0.482814,-0.502982,-0.517599,-0.530277,-0.556612,-0.608315,-0.678413,-0.747405,-0.808195,-0.873945,-0.935503,-0.985541,-1.042627,-1.095004,-1.146228,-1.199549,-1.263654,-1.331535,-1.397981,-1.450478,-1.471918,-1.469725,-1.452981,-1.421656,-1.369567,-1.29527,-1.208911,-1.123352,-1.023086,-0.904738,-0.783331,-0.672739,-0.566601,-0.46834,-0.386876,-0.321116,-0.286864,-0.272411,-0.270733,-0.274976,-0.279362,-0.260719,-0.229501,-0.203147,-0.190345,-0.184622,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,00F,-0.150231,-0.104384,-0.061477,-0.026454,0.013547,0.045152,0.059454,0.058453,0.024978,-0.046194,-0.128799,-0.204851,-0.271353,-0.334438,-0.384442,-0.424927,-0.469737,-0.508701,-0.549798,-0.598212,-0.649293,-0.693904,-0.719921,-0.726681,-0.73734,-0.743766,-0.739187,-0.741978,-0.743666,-0.749845,-0.775176,-0.82489,-0.886092,-0.959414,-1.029691,-1.075738,-1.102809,-1.117056,-1.116691,-1.098408,-1.060288,-1.003159,-0.943622,-0.879662,-0.819488,-0.761042,-0.682734,-0.568869,-0.443301,-0.325492,-0.192441,-0.043288,0.105056,0.223153,0.314502,0.373723,0.410659,0.431694,0.432261,0.422423]
assert 1, eqObj(res, out, precision)
